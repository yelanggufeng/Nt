<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<head>
    <th:block th:include="include :: header('评价')"/>
    <th:block th:include="include :: datetimepicker-css"/>
    <th:block th:include="include :: select2-css"/>
    <link th:href="@{/css/update.css}" rel="stylesheet"/>
    <link th:href="@{/xwyjs/css/style_24.css}" rel="stylesheet"/>
    <link th:href="@{/xwyjs/lib/layui/css/layui.css}" rel="stylesheet"/>
</head>
<body class="white-bg">
<div class="wrapper wrapper-content animated fadeInRight ibox-content">
    <form class="form-horizontal m" id="form-leave-edit" th:object="${bizLeave}">
        <input name="id" th:field="*{id}" type="hidden">
        <input name="taskId" th:field="*{taskId}" type="hidden">
        <input type="hidden" name="p_COM_comment"/>
        <input type="hidden" name="saveEntity" th:value="true"/>
        <input type="hidden" name="status" value="3"/>
        <input name="p_B_applyer" th:value="*{applyUserId}" type="hidden">
        <div class="form-group">
            <label class="col-sm-3 control-label">报修企业：</label>
            <div class="col-sm-8">
                <input name="applyUserName" th:field="*{enterpriseName}" class="form-control" type="text" readonly>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label">报修人：</label>
            <div class="col-sm-8">
                <input name="title" th:field="*{applyUser}" class="form-control" type="text" readonly>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label">报修时间：</label>
            <div class="col-sm-8">
                <div class="input-group date">
                    <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                    <input name="applyTime" th:value="${#dates.format(bizLeave.applyTime, 'yyyy-MM-dd HH:mm')}"
                           class="form-control" type="text" disabled>
                </div>
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label">报修类型：</label>
            <div class="col-sm-8">
                <select name="type" class="form-control m-b" th:with="type=${@dict.getType('report_type')}">
                    <option th:each="dict : ${type}" th:text="${dict.dictLabel}" th:value="${dict.dictValue}"
                            th:field="*{typeId}"></option>
                </select>
            </div>
        </div>

        <div class="form-group">
            <label class="col-sm-3 control-label">报修事项：</label>
            <div class="col-sm-8">
                <textarea name="reason" class="form-control" readonly>[[*{question}]]</textarea>
            </div>
        </div>
        <!--            <div class="form-group">-->
        <!--                <label class="col-sm-3 control-label">开始时间：</label>-->
        <!--                <div class="col-sm-8">-->
        <!--                    <div class="input-group date">-->
        <!--                        <span class="input-group-addon"><i class="fa fa-calendar"></i></span>-->
        <!--                        <input name="startTime" th:value="${#dates.format(bizLeave.startTime, 'yyyy-MM-dd HH:mm')}" class="form-control calcTotalSecondInput" placeholder="yyyy-MM-dd" type="text" disabled>-->
        <!--                    </div>-->
        <!--                </div>-->
        <!--            </div>-->
        <!--            <div class="form-group">-->
        <!--                <label class="col-sm-3 control-label">结束时间：</label>-->
        <!--                <div class="col-sm-8">-->
        <!--                    <div class="input-group date">-->
        <!--                        <span class="input-group-addon"><i class="fa fa-calendar"></i></span>-->
        <!--                        <input name="endTime" th:value="${#dates.format(bizLeave.endTime, 'yyyy-MM-dd HH:mm')}" class="form-control calcTotalSecondInput" placeholder="yyyy-MM-dd" type="text" disabled>-->
        <!--                    </div>-->
        <!--                </div>-->
        <!--            </div>-->
        <!--            <div class="form-group">-->
        <!--                <label class="col-sm-3 control-label">请假时长：</label>-->
        <!--                <div class="col-sm-8">-->
        <!--                    <input name="totalTime" th:field="*{totalTime}" class="form-control" type="text" style="display: none;">-->
        <!--                    <input name="totalTimeText" class="form-control" type="text" readonly>-->
        <!--                </div>-->
        <!--            </div>-->
        <hr/>
        <div class="C124_c_bottom">
            <div class="C124_rate_area f-cl24">
                <div class="C124_rate_t">
                    响应时间：
                </div>
                <div class="C124_rate_0">

                </div>
            </div>
            <div class="C124_rate_area f-cl24">
                <div class="C124_rate_t">
                    维修质量：
                </div>
                <div class="C124_rate_1">

                </div>
            </div>
            <div class="C124_rate_area f-cl24">
                <div class="C124_rate_t">
                    服务态度：
                </div>
                <div class="C124_rate_2">

                </div>
            </div>

            <div class="form-group">
                <label class="col-sm-3 control-label">评论：</label>
                <div class="col-sm-8">
                    <textarea name="comment" class="form-control"></textarea>
                </div>
            </div>
        </div>
        <input type="hidden" id="scoreResponseTime" name="scoreResponseTime" value="">
        <input type="hidden" id="scoreRepairQuality" name="scoreRepairQuality" value="">
        <input type="hidden" id="scoreServiceAttitude" name="scoreServiceAttitude" value="">
        <!--        <div class="form-group" style="display: none"  >-->
        <!--            <label class="col-sm-3 control-label" for="hrApproved">审批意见：</label>-->
        <!--            <div class="col-sm-8">-->
        <!--                <select name="p_B_Approved" id="hrApproved" class="form-control m-b" th:value="1" >-->
        <!--                    <option value="1">同意</option>-->
        <!--                    <option value="2">拒绝</option>-->
        <!--                    <option value="3">退回修改</option>-->
        <!--                </select>-->
        <!--            </div>-->
        <!--        </div>-->


    </form>
</div>
<th:block th:include="include :: footer"/>
<th:block th:include="include :: datetimepicker-js"/>
<th:block th:include="include :: select2-js"/>
<script th:src="@{/xwyjs/lib/layui/layui.js}"></script>

<script th:inline="javascript">
    var prefix = ctx + "repair/repair";
    $("#form-leave-edit").validate({
        focusCleanup: true
    });


    function submitHandler() {
        if ($.validate.form()) {
            if ($('textarea[name="comment"]').val()) {
                $('input[name="p_COM_comment"]').val($('textarea[name="comment"]').val());
            }
            var taskId = [[${taskId}]];
            $.operate.save(prefix + "/completerepair/" + taskId, $('#form-leave-edit').serialize());
        }
    }

    $("input[name='startTime']").datetimepicker({
        autoclose: true
    });

    $("input[name='endTime']").datetimepicker({
        autoclose: true
    });

    $(function () {
        var leave = [[${bizLeave}]];
        var dateSub = $.common.formatTotalDateSub(leave.totalTime);
        $('input[name="totalTimeText"]').val(dateSub);

        // $('select[name="type"]').prop('disabled', true);

        layui.use("rate", function () {
            var rate = layui.rate;

            //渲染
            var ins1 = rate.render({
                elem: ".C124_rate_0", //绑定元素
                choose: function (value) {
                    console.log(value);
                    $("#scoreResponseTime").val(value);
                }
            });

            var ins2 = rate.render({
                elem: ".C124_rate_1", //绑定元素
                choose: function (value) {
                    $("#scoreRepairQuality").val(value);
                }
            });

            var ins3 = rate.render({
                elem: ".C124_rate_2", //绑定元素
                choose: function (value) {
                    $("#scoreServiceAttitude").val(value);
                }
            });
        });
    });

</script>
</body>
</html>
